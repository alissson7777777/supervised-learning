# Проект: Обучение с учителем – Качество модели

    Проект направлен на разработку модели, которая позволит персонализировать предложения для постоянных клиентов интернет-магазина «В один клик» с целью повышения их покупательской активности. 

## Описание проекта
 
Интернет-магазин «В один клик» столкнулся с проблемой снижения активности постоянных покупателей. Новые клиенты уже не привлекают магазин, поэтому важным становится удержание старых. Решением является создание персонализированных предложений для клиентов, чья активность снижалась.

**Задача:**  
- **Целевой признак:** Покупательская активность, которая принимает два значения – «снизилась» и «прежний уровень».
- **Цели модели:** Предсказать вероятность того, что покупатель в следующие 3 месяца будет покупать меньше (то есть активность снизится).

**Дополнительные данные:**  
Помимо исходных данных о поведении покупателей (коммуникации, продуктовое поведение, покупательское поведение, поведение на сайте), в исследование включены данные о прибыльности клиента за последние три месяца, предоставленные финансовым департаментом.

## Цель проекта

Цель проекта — разработать и внедрить модель машинного обучения, которая:
- Прогнозирует вероятность снижения покупательской активности постоянного клиента.
- Используя прогнозы и данные о прибыльности, позволяет сегментировать клиентов для разработки персонализированных предложений с целью увеличения их активности.

# Выводы по проекту 

## Основные закономерности покупательского поведения
 **Активность пользователей**
- **40% клиентов** демонстрируют **снижение активности**, что создает **риск оттока**.
- **Средняя вовлеченность** на сайте (по просмотрам страниц и времени) **оказывает значительное влияние на активность**.
- Клиенты, ориентированные **на скидки**, могут быстро потерять интерес без регулярных акционных предложений.

**Маркетинговая активность**
- **Уровень взаимодействия с маркетинговыми кампаниями стабильный**, но его влияние на активность клиентов неоднозначно.
- **Программы рассылок и таргетированных предложений** могут требовать дальнейшей настройки.

**Категории товаров**
- **Покупатели товаров длительного пользования** (электроника, бытовая техника) демонстрируют **более стабильное поведение**, реже попадая в сегменты риска.
- **Покупатели косметики и товаров для здоровья** имеют **высокую вероятность снижения активности**, что требует **дополнительных стимулов** для удержания.

## Результаты моделирования

В ходе исследования были протестированы **различные алгоритмы машинного обучения**:
- **DecisionTreeClassifier**
- **KNeighborsClassifier**
- **LogisticRegression**
- **SVC**

Для улучшения качества моделей были применены:
- Предобработка данных (кодирование категориальных признаков, стандартизация, полиномиальные признаки).
- Оптимизация гиперпараметров через **OptunaSearchCV**.

 **Выбор наилучшей модели**
На основании **метрики ROC AUC**, лучшей оказалась модель **LogisticRegression** с параметрами:
```python
{'models': LogisticRegression(C=6, penalty='l1', random_state=42, solver='saga')}
```
## Выводы по сегментации покупателей**
На основании корреляционного анализа были выделены **ключевые группы клиентов**, требующие особого внимания.

**Группа 1: Высокая вероятность снижения активности и высокая прибыльность**
- **Основные факторы влияния**:  
  - **Акционные покупки за 6 месяцев (0.244)** → высокая чувствительность к скидкам и промоакциям.  
  - **Среднее количество страниц за визит за 3 месяца (0.526)** → активное изучение каталога, но не всегда завершение покупки.  
  - **Выручка за предыдущие месяцы (0.413)**  
  - **Время, проведенное на сайте за предыдущий месяц (0.513)**  

- **Рекомендации**:  
  - Персонализированные скидки и бонусные программы.  
  - Улучшение **рекомендационной системы** и интерфейса сайта.  
  - Удержание клиентов через **автоматизированные напоминания**.

---

**Группа 2: Высокая доля акционных покупок и высокая вероятность снижения активности**
- **Основные факторы влияния**:  
  - **Среднее количество страниц за визит за 3 месяца (0.619)**  
  - **Время, проведенное на сайте за предыдущий месяц (0.649)**  
  - **Высокая зависимость от скидок** → возможный уход при отсутствии промоакций.  

- **Рекомендации**:  
  - Введение **программы лояльности** для клиентов, ориентированных на акции.  
  - Разработка **специальных предложений** для удержания таких покупателей.  
  - Улучшение **таргетинга** на основе анализа их истории покупок.  

---

**Группа 3: Высокий риск снижения активности и низкая доля аукционных покупок**
- **Основные факторы влияния**:  
  - **Прибыль (0.333)**  
  - **Акционные покупки за 6 месяцев (0.292)**  
  - **Среднее количество страниц за визит за 3 месяца (0.246)**  
  - **Время на сайте за предыдущий месяц (0.247)**  

- **Рекомендации**:  
  - Разработка **ценностных предложений**, не завязанных на скидках.  
  - Улучшение ассортимента и качества контента (детальные описания, видеообзоры).  
  - Персонализированные рекомендации и **динамическое ценообразование**.  

---

**Группа 4: Анализ категорий товаров**

  - Покупатели **товаров длительного пользования** демонстрируют **наименьший риск оттока**.  
  - Покупатели **косметики и товаров для красоты и здоровья** чаще **снижают активность**.  

- **Рекомендации**:  
  - **Расширение ассортимента косметики** и товаров для красоты.  
  - Продвижение **лимитированных коллекций, новых брендов**.  
  - Поддержка **дополнительных акций** для привлечения внимания.  